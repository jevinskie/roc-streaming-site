<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Audio backends &#8212; Roc Toolkit 0.3.0</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/nature.css?v=601dbdee" />
    <link rel="stylesheet" type="text/css" href="../_static/roc.css?v=37117d08" />
    <script src="../_static/documentation_options.js?v=e259d695"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Development" href="../development.html" />
    <link rel="prev" title="Network protocols" href="network_protocols.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../development.html" title="Development"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="network_protocols.html" title="Network protocols"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Roc Toolkit 0.3.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../internals.html" accesskey="U">Internals</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Audio backends</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="audio-backends">
<h1>Audio backends<a class="headerlink" href="#audio-backends" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of contents:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#i-o-uri" id="id1">I/O URI</a></p></li>
<li><p><a class="reference internal" href="#sinks-and-sources" id="id2">Sinks and sources</a></p></li>
<li><p><a class="reference internal" href="#backends-and-drivers" id="id3">Backends and drivers</a></p></li>
<li><p><a class="reference internal" href="#supported-backends" id="id4">Supported backends</a></p></li>
</ul>
</nav>
<section id="i-o-uri">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">I/O URI</a><a class="headerlink" href="#i-o-uri" title="Link to this heading">¶</a></h2>
<p>Input/output device or file is identified via I/O URI, which have one of the following forms:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>syntax</p></th>
<th class="head"><p>meaning</p></th>
<th class="head"><p>example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;driver&gt;://&lt;device&gt;</span></code></p></td>
<td><p>audio device name</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">alsa://hw:0</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;driver&gt;://default</span></code></p></td>
<td><p>default audio device</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pulse://default</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">file://&lt;abs_path&gt;</span></code></p></td>
<td><p>audio file (absolute path)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file:///home/user/test.wav</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">file:&lt;rel_path&gt;</span></code></p></td>
<td><p>audio file (relative path)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file:./test.wav</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">file://-</span></code> or <code class="docutils literal notranslate"><span class="pre">file:-</span></code></p></td>
<td><p>stdin or stdout</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">file:-</span></code></p></td>
</tr>
</tbody>
</table>
<p>User can specify input file/device (<strong>source</strong>) for <code class="docutils literal notranslate"><span class="pre">roc-send</span></code> via <code class="docutils literal notranslate"><span class="pre">--input</span></code> option, and output file/device (<strong>sink</strong>) for <code class="docutils literal notranslate"><span class="pre">roec-recv</span></code> via <code class="docutils literal notranslate"><span class="pre">--output</span></code> option.</p>
<p>When device is used, user specifies driver explicitly (e.g. <code class="docutils literal notranslate"><span class="pre">alsa://</span></code> for ALSA, <code class="docutils literal notranslate"><span class="pre">pulse://</span></code> for PulseAudio, etc). When file is used, file driver is selected automatically, usually by file extension. However, user may force usage of specific driver for the file via <code class="docutils literal notranslate"><span class="pre">--input-format</span></code> or <code class="docutils literal notranslate"><span class="pre">--output-format</span></code> option.</p>
<p>See <a class="reference internal" href="../manuals.html"><span class="doc">manual pages</span></a> for more details.</p>
</section>
<section id="sinks-and-sources">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Sinks and sources</a><a class="headerlink" href="#sinks-and-sources" title="Link to this heading">¶</a></h2>
<p>To abstract files and devices, <code class="docutils literal notranslate"><span class="pre">roc_sndio</span></code> module defines three interfaces:</p>
<ul class="simple">
<li><p>device interface (<a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1sndio_1_1IDevice.html">IDevice</a>) - parent interface for input/output file/device</p></li>
<li><p>source interface (<a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1sndio_1_1ISource.html">ISource</a>) - child interface for input file/device</p></li>
<li><p>sink interface (<a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1sndio_1_1ISink.html">ISink</a>) - child interface for output file/device</p></li>
</ul>
<p>For different types of devices and files, there may be different implementations of <code class="docutils literal notranslate"><span class="pre">ISource</span></code> and <code class="docutils literal notranslate"><span class="pre">ISink</span></code>.</p>
<p>The same two interfaces (<code class="docutils literal notranslate"><span class="pre">ISource</span></code> and <code class="docutils literal notranslate"><span class="pre">ISink</span></code>) are also implemented by sender pipeline (<a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1pipeline_1_1SenderSink.html">SenderSink</a>) and receiver pipeline (<a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1pipeline_1_1ReceiverSource.html">ReceiverSource</a>). See more details in <a class="reference internal" href="pipelines.html"><span class="doc">Media pipelines</span></a>.</p>
<p>The job of <code class="docutils literal notranslate"><span class="pre">roc-send</span></code> and <code class="docutils literal notranslate"><span class="pre">roc-recv</span></code> is thus to open a source and a sink and to transfer audio from source to sink:</p>
<ul class="simple">
<li><p>in <code class="docutils literal notranslate"><span class="pre">roc-send</span></code>, <code class="docutils literal notranslate"><span class="pre">ISource</span></code> is implemented by device or file from <code class="docutils literal notranslate"><span class="pre">roc_sndio</span></code>, and <code class="docutils literal notranslate"><span class="pre">ISink</span></code> is implemented by sender pipeline from <code class="docutils literal notranslate"><span class="pre">roc_pipeline</span></code></p></li>
<li><p>in <code class="docutils literal notranslate"><span class="pre">roc-recv</span></code>, <code class="docutils literal notranslate"><span class="pre">ISource</span></code> is implemented by receiver pipeline from <code class="docutils literal notranslate"><span class="pre">roc_pipeline</span></code>, and <code class="docutils literal notranslate"><span class="pre">ISink</span></code> is implemented by device or file from <code class="docutils literal notranslate"><span class="pre">roc_sndio</span></code></p></li>
</ul>
<p>The task of transferring sound from <code class="docutils literal notranslate"><span class="pre">ISource</span></code> to <code class="docutils literal notranslate"><span class="pre">ISink</span></code> is implemented in <a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1sndio_1_1Pump.html">sndio::Pump</a> class, which works uniformely with any pair of source and sink, being it file, device, or pipeline.</p>
</section>
<section id="backends-and-drivers">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Backends and drivers</a><a class="headerlink" href="#backends-and-drivers" title="Link to this heading">¶</a></h2>
<p>Top-level class of <code class="docutils literal notranslate"><span class="pre">roc_sndio</span></code> is <strong>backend dispatcher</strong> (<a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1sndio_1_1BackendDispatcher.html">BackendDispatcher</a>), which holds all registered backends and decides which backend to use when opening sink or source.</p>
<p>Every <strong>backend</strong> (<a class="reference external" href="https://roc-streaming.org/toolkit/doxygen/classroc_1_1sndio_1_1IBackend.html">IBackend</a>) may implement one or more <strong>drivers</strong>, identified by string name.</p>
<p>For example, SoxBackend (backend that implements audio I/O using SoX library) implements several device and file drivers: <code class="docutils literal notranslate"><span class="pre">alsa</span></code>, <code class="docutils literal notranslate"><span class="pre">pulse</span></code>, <code class="docutils literal notranslate"><span class="pre">mp3</span></code>, etc. Every device driver corresponds to particular sound system (e.g. ALSA, PulseAudio), and every file driver corresponds to particular file format (e.g. MP3).</p>
<p>When user asks backend dispatcher to open sink or source, user speicifies I/O URI and, for files, optional file format (i.e. driver name). Backend dispatcher then finds backend which is able to handle given device or file and asks it to create its implementation of <code class="docutils literal notranslate"><span class="pre">ISource</span></code> or <code class="docutils literal notranslate"><span class="pre">ISink</span></code>.</p>
<p>To help backend dispatcher with making decision, backends provide <strong>driver information</strong> about every available driver:</p>
<ul class="simple">
<li><p><em>driver name</em> – short unique string, for devices same as URI scheme (e.g. <code class="docutils literal notranslate"><span class="pre">alsa</span></code>), for files usually same as file extension (e.g. <code class="docutils literal notranslate"><span class="pre">mp3</span></code>)</p></li>
<li><p><em>driver type</em> – whether it’s device or file driver</p></li>
<li><p><em>driver flags</em> – whether driver supports sources and/or sinks, and whether driver should be used by default</p></li>
</ul>
</section>
<section id="supported-backends">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Supported backends</a><a class="headerlink" href="#supported-backends" title="Link to this heading">¶</a></h2>
<p>To get list of supported device and file drivers, run <code class="docutils literal notranslate"><span class="pre">roc-recv</span></code> or <code class="docutils literal notranslate"><span class="pre">roc-send</span></code> with <code class="docutils literal notranslate"><span class="pre">--list-supported</span></code> option.</p>
<p>Most backends may be disabled at compile-time, so this list depends on build options.</p>
<p>The following table lists implemented audio backends:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>backend</p></th>
<th class="head"><p>drivers</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SoxBackend</p></td>
<td><p>many</p></td>
<td><p>universal backend that supports many audio systems and file formats using libsox</p></td>
</tr>
<tr class="row-odd"><td><p>PulseaudioBackend</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pulse</span></code></p></td>
<td><p>native PulseAudio backend using libpulse</p></td>
</tr>
</tbody>
</table>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo80.png" alt="Logo"/>
            </a></p>
<h3><a href="../index.html">Table of Contents</a></h3>
<p class="caption" role="heading"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about_project.html">About project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../building.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manuals.html">Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../portability.html">Portability</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../internals.html">Internals</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_structure.html">Code structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="threads.html">Threads and queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipelines.html">Media pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="packets_frames.html">Packets and frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="timestamps.html">Timestamps</a></li>
<li class="toctree-l2"><a class="reference internal" href="fec.html">Forward Erasure Correction codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="fe_resampler.html">Frequency estimator and resampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="network_protocols.html">Network protocols</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Audio backends</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../development.html" title="Development"
             >next</a> |</li>
        <li class="right" >
          <a href="network_protocols.html" title="Network protocols"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Roc Toolkit 0.3.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../internals.html" >Internals</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Audio backends</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Roc Streaming authors.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    </div>
  </body>
</html>